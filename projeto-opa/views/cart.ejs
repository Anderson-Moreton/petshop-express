<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Righteous&family=Ropa+Sans&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/carrinho.css">
    <title>Opa Dog e Burguer</title>
</head>

<body>
    <header>
        <%-include ('./partials/header') %>
    </header>
    <main>
        <section class="banner">
            <img class="style-image" src="/img/meuCarrinho.jpg" alt="">
            <p class="style-title">Meu Carrinho</p>
        </section>
        <section class="container">
            <div id="carrinho" class="row-box">
            </div>
            <%- include('partials/carrinho') %>
                <script src='/js/exibirCarrinho.js'></script>
        </section>
        <button id="buyButton">Comprar</button>
    </main>
    <footer>
        <%-include ('./partials/footer') %>
    </footer>
</body>
<script>
    var buyButton = document.getElementById("buyButton");
    const carrinho = localStorage.getItem('carrinho')
        ? JSON.parse(localStorage.getItem('carrinho'))
        : [];

    buyButton.onclick = function () {
        fetch("/carrinho/comprar", {
            method: "POST",
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                products: carrinho
            })
        }).then(response => {
            console.log(response.body.result)
        }).catch(error => {
            console.log(error)
        })
    }
</script>

</html>